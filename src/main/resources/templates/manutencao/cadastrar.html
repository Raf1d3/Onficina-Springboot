<!DOCTYPE html>
<html lang="pt-BR" layout:decorate="~{layout/layoutpadrao}" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <title>Cadastrar Manutenção</title>
</head>

<body>
    <!-- conteudo principal -->
    <main layout:fragment="conteudo" th:fragment="formulario" id="main">
        <div th:replace="~{layout/fragments/csrf :: csrf}"></div>
        <div>
            <div class="rounded-lg shadow-xl">
                <h2 class="text-3xl font-bold text-white">Cadastrar Manutenção</h2>
                <p class="text-gray-400 mb-6">Preencha as informações abaixo para registrar uma nova manutenção.</p>

                <div class="bg-gray-800 p-6 md:p-8 rounded-xl shadow-md">
                    <form th:hx-post="@{/manutencao/cadastrar}" hx-target="#main" hx-swap="outerHTML" th:object="${manutencao}">
                        <div th:if="${#fields.hasAnyErrors()}" class="p-4 mb-6 text-sm text-red-800 rounded-lg bg-red-100" role="alert">
                            <span class="font-medium">Por favor, corrija os erros abaixo.</span>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
                            <div >
                                <label for="veiculo" class="block text-sm font-medium mb-2 text-gray-300">Veículo*</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M4 2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-1Zm1 2A.5.5 0 0 1 5.5 4h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-1Zm0 3A.5.5 0 0 1 5.5 7h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-1Z"/>
                                            <path d="M2 1a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-1H2Zm12 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h12Z"/>
                                        </svg>
                                    </div>
                                    <select id="veiculo" name="veiculo.id" required
                                            class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500">
                                        <option value="">Selecione um veículo</option>
                                        <th:block th:each="veiculo : ${veiculos}">
                                            <option th:value="${veiculo.id}" th:text="${veiculo.modelo} + ' - ' + ${veiculo.placa}"></option>
                                        </th:block>
                                    </select>
                                    <p th:if="${#fields.hasErrors('veiculo')}" th:errors="*{veiculo}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div>
                                <label for="oficina" class="block text-sm font-medium mb-2 text-gray-300">Oficina</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                                        </svg>
                                    </div>
                                    <select id="oficina" name="oficina.id"
                                            class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500">
                                        <option value="">Selecione uma oficina</option>
                                        <th:block th:each="oficina : ${oficinas}">
                                            <option th:value="${oficina.id}" th:text="${oficina.nome}"></option>
                                        </th:block>
                                    </select>
                                    <p th:if="${#fields.hasErrors('oficina')}" th:errors="*{oficina}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div>
                                <label for="dataInicioManutencao" class="block text-sm font-medium mb-2 text-gray-300">Data Início da manutenção</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M6.5 0a.5.5 0 0 0-.5.5V1h4V.5a.5.5 0 0 0-1 0V1H6.5V.5Zm-2 0A1.5 1.5 0 0 0 3 1.5v1A1.5 1.5 0 0 0 4.5 4h7A1.5 1.5 0 0 0 13 2.5v-1A1.5 1.5 0 0 0 11.5 0h-7Zm2 1h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5Zm-2 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5ZM3 4.5a.5.5 0 0 1-1 0V2a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4.5Z"/>
                                        </svg>
                                    </div>
                                    <input type="datetime-local" th:field="*{dataInicioManutencao}"
                                           class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500"/>
                                    <p th:if="${#fields.hasErrors('dataInicioManutencao')}" th:errors="*{dataInicioManutencao}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                             <div>
                                <label for="dataProximaManutencao" class="block text-sm font-medium mb-2 text-gray-300">Data da Próxima Manutenção</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M6.5 0a.5.5 0 0 0-.5.5V1h4V.5a.5.5 0 0 0-1 0V1H6.5V.5Zm-2 0A1.5 1.5 0 0 0 3 1.5v1A1.5 1.5 0 0 0 4.5 4h7A1.5 1.5 0 0 0 13 2.5v-1A1.5 1.5 0 0 0 11.5 0h-7Zm2 1h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5Zm-2 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H4.5a.5.5 0 0 1-.5-.5ZM3 4.5a.5.5 0 0 1-1 0V2a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4.5Z"/>
                                        </svg>
                                    </div>
                                    <input type="datetime-local" th:field="*{dataProximaManutencao}"
                                           class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500"/>
                                    <p th:if="${#fields.hasErrors('dataProximaManutencao')}" th:errors="*{dataProximaManutencao}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div class="md:col-span-2">
                                <label for="descricao" class="block text-sm font-medium mb-2 text-gray-300">Descrição</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M12 1H4a1 1 0 0 0-1 1v14l4-4 4 4V2a1 1 0 0 0-1-1Zm-1 2v10.795l-2-2-2 2V3h4Z"/>
                                        </svg>
                                    </div>
                                    <input type="text" th:field="*{descricao}"
                                           class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500"/>
                                    <p th:if="${#fields.hasErrors('descricao')}" th:errors="*{descricao}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div class="md:col-span-2"> 
                                <label for="observacao" class="block text-sm font-medium mb-2 text-gray-300">Observação</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M12 1H4a1 1 0 0 0-1 1v14l4-4 4 4V2a1 1 0 0 0-1-1Zm-1 2v10.795l-2-2-2 2V3h4Z"/>
                                        </svg>
                                    </div>
                                    <textarea th:field="*{observacao}"
                                              class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500"></textarea>
                                    <p th:if="${#fields.hasErrors('observacao')}" th:errors="*{observacao}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div class="grid grid-cols- md:grid-cols-3 gap-4">
                            <div>
                                <label for="tipoManutencao" class="block text-sm font-medium mb-2 text-gray-300">Tipo de Manutenção</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2Zm2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4Z"/>
                                            <path d="M2 6a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6Zm1-1h10v2H3V5Z"/>
                                        </svg>
                                    </div>
                                    <select th:field="*{tipoManutencao}" class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500">
                                        <option value="">Selecione</option>
                                        <option th:value="PREVENTIVA">Preventiva</option>
                                        <option th:value="CORRETIVA">Corretiva</option>
                                    </select>
                                    <p th:if="${#fields.hasErrors('tipoManutencao')}" th:errors="*{tipoManutencao}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div>
                                <label for="statusManutencao" class="block text-sm font-medium mb-2 text-gray-300">Status da Manutenção</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2Zm2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4Z"/>
                                            <path d="M2 6a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6Zm1-1h10v2H3V5Z"/>
                                        </svg>
                                    </div>
                                    <select th:field="*{statusManutencao}" class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500">
                                        <option value="">Selecione</option>
                                        <option th:value="AGENDADA">Agendada</option>
                                        <option th:value="EM_ANDAMENTO">Em andamento</option>
                                        <option th:value="FINALIZADA">Finalizada</option>
                                    </select>
                                    <p th:if="${#fields.hasErrors('statusManutencao')}" th:errors="*{statusManutencao}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium mb-2 text-gray-300">Tipo de Serviço</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2Zm2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H4Z"/>
                                            <path d="M2 6a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6Zm1-1h10v2H3V5Z"/>
                                        </svg>
                                    </div>
                                    <select id="tipoServico" th:field="*{tipoServico}" class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500" onchange="toggleOutroServico()">
                                        <option value="">Selecione</option>
                                        <option value="TROCA_OLEO">Troca de Óleo</option>
                                        <option value="TROCA_PNEUS">Troca de Pneus</option>
                                        <option value="ALINHAMENTO">Alinhamento</option>
                                        <option value="BALANCEAMENTO">Balanceamento</option>
                                        <option value="REPARO_FREIOS">Reparo de Freios</option>
                                        <option value="TROCA_BATERIA">Troca de Bateria</option>
                                        <option value="OUTRO">Outro</option>
                                    </select>
                                    <p th:if="${#fields.hasErrors('tipoServico')}" th:errors="*{tipoServico}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>
                            </div>

                            <div id="outroServicoDiv" style="display:none;" class="mt-5">
                                <label class="block text-sm font-medium mb-2 text-gray-300">Descreva o serviço</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M12 1H4a1 1 0 0 0-1 1v14l4-4 4 4V2a1 1 0 0 0-1-1Zm-1 2v10.795l-2-2-2 2V3h4Z"/>
                                        </svg>
                                    </div>
                                    <input type="text" id="outroServico" th:field="*{descricaoOutroServico}" name="outroServico"
                                           class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500"/>
                                    <p th:if="${#fields.hasErrors('descricaoOutroServico')}" th:errors="*{descricaoOutroServico}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                            <div>
                                <label for="valorServico" class="block text-sm font-medium mb-2 text-gray-300">Valor do Serviço</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                        <svg class="w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M.5 1a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H.5Zm0 2a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H.5Zm0 2a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H.5Zm0 2a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H.5Zm0 2a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1H.5Z"/>
                                        </svg>
                                    </div>
                                    <input type="number" step="0.01" th:field="*{valorServico}"
                                           class="py-3 px-12 block w-full bg-gray-700 border-gray-600 rounded-lg text-white focus:border-blue-500 focus:ring-blue-500"/>
                                    <p th:if="${#fields.hasErrors('valorServico')}" th:errors="*{valorServico}" class="text-sm text-red-600 mt-1"></p>
                                </div>
                            </div>

                           
                        </div>

                        <div class="mt-8 pt-6 border-t border-gray-700 flex justify-end">
                            <button type="submit"
                                    class="py-2 px-6 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 transition-all duration-200">
                                Cadastrar
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div th:if="${notificacao != null}" th:object="${notificacao}" class="mt-6">
                <input type="hidden" id="mensagem" th:value="*{mensagem}">
                <input type="hidden" id="tipo" th:value="*{tipo}">
                <input type="hidden" id="intervalo" th:value="*{intervalo}">
            </div>
        </div>
    </main>

    <script>
        function toggleOutroServico() {
            const select = document.getElementById('tipoServico');
            const outroDiv = document.getElementById('outroServicoDiv');
            if (select !== null) {
                if (select.value === 'OUTRO') {
                    outroDiv.style.display = 'block';
                } else {
                    outroDiv.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>